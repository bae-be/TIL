# 네트워크의 기본
> 이 문서는 '그림으로 배우는 네트워크 원리'라는 책을 기반으로 한 지식 정리 문서입니다.  
책을 읽으며 생긴 질문은 ❗️이모티콘으로 구분했습니다.

## 1. 사내 네트워크의 구성

### LAN과 WAN
- **LAN (Local Area Network)** : **같은 장소 안에서 사용**하는 네트워크를 뜻한다. 이 장소는 집이나 작은 회사처럼 하나의 공간일 수 있고, LAN을 통해 같은 장소 안에 있는 여러 기기들이 서로 연결되어 인터넷을 사용하거나 파일을 공유할 수 있게 된다.
- **WAN (Wide Area Network)** : **멀리 떨어진 장소들을 연결**하는 네트워크를 뜻한다. 대규모 회사가 본사와 지사를 가지고 있을 때, 모든 지사들이 서로 연결되어 정보를 주고 받아야 할 것이다. 이때 WAN을 사용하면 다른 도시나 지역에 있는 사무실들도 마치 같은 공간에 있는 것처럼 네트워크를 연결할 수 있다.
- **LAN**의 경우 직접 구축하고 관리해야하며 설계와 구축 인건비, 기기 비용, 관리자 인건비가 발생한다.  
**WAN**의 경우 ISP 사업자가 구축하고 관리하며 서비스 계약 요금, 통신 요금이 발생한다.

### LAN의 기술
- 이더넷 (Ethernet) : 가장 일반적인 LAN 기술이며 대부분의 가정, 사무실, 학교 등에서 사용한다. 설정 및 사용이 간단하며 저렴하고 안정적이지만 상대적으로 느린 속도 **(최대10Mbps)** 로 대용량 데이터 전송에는 적합하지 않다.
- 토큰링 (Token Ring) : IBM이 개발한 네트워크 방식으로 과거 일부 기업환경에서 사용되었으나 현재는 거의 사용되지 않는다.
- FDDI (Fiber Distributed Data Interface) : 대규모 네트워크에서 고속 데이터 전송이 필요할 때 사용되며 주로 광케이블 기반의 네트워크에서 사용한다. 현재는 빠르고 저렴한 대안이 있어 사용 빈도가 적다.  
- 패스트 이더넷 (Fast Ethernet) : 이더넷의 느린 속도를 개선한 **(최대 100Mbps)** 기술이고 가정이나 중소기업에서 많이 사용되었다.
- Gigabit 이더넷 : 고속 **(최대 1Gbps)** 데이터 전송이 필요한 환경에서 사용한다.
- ATM (Asynchronous Transfer Mode) : 음성, 데이터, 비디오 등 다양한 트래픽을 하나의 네트워크로 통합해 전송하는데 사용되었으며 현재는 IP 기반의 기술이 주류가 되면서 점차 사용이 줄어들고 있다.

### ❗️일반적인 상황에서 ISP 사업자(SK, KT 등)가 제공하는 100MB, 500MB, 1GB 인터넷을 사용할텐데 이건 이더넷이라고 통칭할 뿐 사실상 100MB는 패스트 이더넷, 500MB, 1GB는 Gigabit 이더넷이라고 봐야할까?
> 기본적으로 ISP 사업자가 제공하는 500Mbps, 1Gbps 인터넷은 **Gigabit 이더넷 기술을 기반**으로 제공됩니다. 가정용 인터넷 연결에 사용되는 케이블이나 장비(라우터, 스위치 등) 역시 Gigabit 이더넷을 지원하도록 설계되어 있습니다. 따라서, 요즘은 100Mbps 인터넷을 사용하더라도 **네트워크 장비는 대부분 Gigabit 이더넷을 사용**하며, 실제 속도는 사용자가 선택한 요금제나 연결 방식에 따라 제한될 수 있습니다.

### ❗️ 위 FDDI 내용 중 "현재는 빠르고 저렴한 대안이 있어 사용빈도가 적다." 부분에서 FDDI의 대안은 무엇이 있을까?
> Gigabit 이더넷, 10 Gigabit 이더넷 (10GbE), 광케이블 기반 네트워크 (Fiber Optic Network), SONET/SDH (Synchronous Optical Networking/Synchronous Digital Hierarchy)이 있다.

### WAN의 기술과 프로토콜
- PSTN (Public Switched Telephone Network)
- ISDN (Integrated Services Digital Network)
- Frame Relay
- ATM (Asynchronous Transfer Mode)
- MPLS (Multiprotocol Label Switching)
- VPN (Virtual Private Network)
- SD-WAN (Software-Defined WAN)
- Leased Line (전용 회선)
- Satellite WAN
- Cellular Network (3G, 4G, 5G)

### 네트워크의 네트워크
- 누구나 이용할 수 있는 인터넷은 전세계의 다양한 조직이 관리하는 네트워크가 연결된 것이다. 그 조직의 네트워크를 AS(Autonomous System)라고 부른다. AS의 구체적인 예는 인터넷 접속 서비스를 제공하는 SK, KT, LG U+와 같은 ISP(인터넷 서비스 프로바이더)이다. Google이나 Amazon 등 인터넷 상에서 서비스를 제공하는 기업 네트워크도 AS이다.
- 인터넷 상의 모든 ISP는 Tier1을 경유해서 연결된다. 사용자는 인터넷을 이용할 때 어딘가의 ISP와 인터넷 접속 서비스를 계약하며, 자신이 계약한 ISP의 사용자뿐만 아니라 다른 ISP의 사용자와도 통신할 수 있다.

### ❗️네트워크의 네트워크 내용 중 "Google과 Amazon 등 인터넷 상에서 서비스를 제공하는 기업 네트워크도 AS이다." 부분에서 ISP 외에 Google과 Amazon도 AS 인 이유는 뭘까?
> 두 기업 모두 인터넷 사용자나 서비스 제공자 이상으로, **자체적인 독립된 네트워크**를 운영하고 있기 때문이다. AS는 하나의 독립적인 네트워크 운영 단위로 고유한 **AS 번호(ASN)** 를 가지고, 인터넷을 통해 **다른 AS와 상호 연결**된다.  
AS는 독립적인 네트워크를 운영하고 고유한 AS 번호(ASN)을 가지고 있으며 BGP(Border Gateway Protocol) 프로토콜을 사용한다.

### 통신에서 이용하는 언어
- 네트워크의 공통 언어는 대부분 TCP/IP를 사용한다.
- TCP/IP의 계층 및 주요 프로토콜
    - **애플리케이션층** : HTTP, SMTP, POP3, IMAP4, DHCP, DNS 등
    - **트랜스포트층** : TCP, UDP
    - **인터넷층** : IP, ICMP, ARP 등
    - **네트워크 인터페이스층** : 이더넷, 무선 LAN, PPP 등

### ❗️TCP/IP의 주요 프로토콜 중 PPP와 ICMP 프로토콜은 무엇이며 어떨때 사용할까?
> **ICMP(Internet Control Message Protocol)** : TCP/IP 네트워크에서 중요한 진단 및 오류 보고를 위한 프로토콜이다. 따라서 ICMP는 데이터를 전달하는 것이 아니라 네트워크 문제를 진단하고 오류를 알리는 용도로 사용된다.  
**PPP(Point-to-Point Protocol)** : TCP/IP 네트워크에서 두 지점 간에 데이터를 전송하는 표준 프로토콜이다. 이전에는 전화선을 통해 인터넷에 연결하던 때 많이 사용되었으며, 지금도 VPN에서 사용되고 있다.

### ❗️네트워크 연결 확인할 때 자주 사용하는 ping 명령어가 ICMP 프로토콜을 이용하는건가?
> ping 명령어는 ICMP의 Echo Request(Type 8) 메시지를 목적지에 보내고 목적지에서는 Echo Reply(Tpye 0) 메시지를 출발지에 보내준다. 이때 목적지에서 Echo Reply 메시지가 수신되지 않는다면 연결되지 않았음을 확인할 수 있다.

### 서버 운용 및 관리
- **온프레미스**는 직접 서버를 운용 관리하는 운영 방법이다.
- **클라우드 서비스**는 인터넷을 통해 서버의 기능만 이용할 수 있는 서비스이다.

### 클라우드 서비스의 분류
- Iaas(Infrastructure as a Service) : 서버, 네트워크, OS, 스토리지의 서비스를 가상화하여 제공하고 관리한다. (IaaS의 제공 업체는 서버, 하드 드라이브, 네트워킹, 가상화 및 스토리지를 관리한다.)  
```ex) AWS EC2, NHN Cloud Instance 등```
- PaaS(Platform as a Service) : IaaS + OS, 미들웨어끼지 제공한다. (사용자는 애플리케이션을 구축하고 배포만 한다.)  
```ex) AWS Elastic Beanstalk, NHN Cloud RDS 등```
- SaaS(Software as a Service) : IaaS + PaaS + 애플리케이션 형태로 제공한다.  
```ex) 네이버 MYBOX, 구글 드라이브 등```

## 2. 네트워크를 만드는 것

### 기본적인 네트워크 기기
- 라우터
- 레이어2 스위치
- 레이어3 스위치

### 네트워크 설계 프로세스
- 요건정의 : 네트워크에 필요한 기능과 성능을 명확히 한다.
- 설계 : 요건정의에서 결정한 요건을 만족할 수 있도록 구체적인 네트워크 구성을 결정한다.
- 구축 : 설계한 네트워크를 바탕으로 기기의 배치, 배선, 필요한 설정을 한다.
- 운용관리 : 네트워크가 정상으로 동작하도록 점검한다. 문제가 있으면 원인을 파악해 복구한다.

## 3. 네트워크의 공통 언어 TCP/IP

### 데이터 송수신 규칙
- TCP/IP에서는 4개의 프로토콜을 조합하여 송수신 한다. 각 프로토콜에는 각각의 기능을 실현하기 위한 제어정보(헤더)가 필요하다.
- 웹브라우저의 데이터에 계층의 상위 프로토콜부터 차례대로 헤더를 추가해 간다.  
![TCP/IP Protocol Image](https://github.com/bae-be/TIL/blob/main/Image/TCP:IP%20Protocol.png?raw=true)

### 계층별로 데이터를 부르는 방법
- 애플리케이션층 : 메시지
- 트랜스포트층 : 세그먼트(TCP), 데이터그램(UDP)
- 인터넷층 : 패킷 또는 데이터그램
- 네트워크 인터페이스층 : 프레임

### 데이터를 전송하는 주소의 차이
- 유니캐스트 : 단 한곳으로 데이터를 전송하는 것을 유니캐스트라고 한다. 만약 완전히 같은 데이터를 복수의 주소로 전송하고 싶을 때는 출발지에서 목적지 수 만큼 유니캐스트 데이터 전송을 반복하면 되지만, 효율이 좋지않아 복수의 주소로 효율적인 전송을 위해서 브로드캐스트와 멀티캐스트를 사용한다.
- 브로드캐스트 : 같은 네트워크 상의 모든 호스트에 완전히 똑같은 데이터를 전송하는 것을 브로드캐스트라고 한다.
- 멀티캐스트 : 같은 애플리케이션이 동작하는 등 특정 그룹에 포함되는 호스트에 완전히 똑같은 데이터를 전송하는 것을 멀티캐스트라고 한다.

### ❗️데이터를 전송할 때 멀티캐스트를 이용하는 대표적인 예시에는 어떤것이 있을까?
- IPTV : TV 방송을 실시간으로 다수의 사용자에게 전송
- 온라인 강의, 웹 세미나 (Webinar) : 여러 학생이나 참가자가 동시에 같은 강의를 듣는 온라인 강의 플랫폼에서 실시간 스트리밍을 멀티캐스트로 전송
- 주식 거래 시스템 : 금융 시장에서 실시간 데이터(주식 가격, 거래 정보 등)를 많은 트레이더와 시스템에 전송
- 비디오 회의 시스템 : 다자간 화상 회의에서 참가자 모두에게 회의 영상이나 음성을 동시에 전송
- 온라인 게임 : 실시간 멀티플레이어 게임에서 게임 서버가 모든 플레이어에게 게임 상태 정보(캐릭터 위치, 움직임 등)를 지속적으로 전송

### 유니캐스트 IP 주소의 구성
- PC와 서버 등 TCP/IP 통신을 하는 호스트에 설정하는 IP 주소는 유니캐스트 IP 주소이다. IP 주소는 네트워크부와 호스트부라는 두 개의 부분으로 구성 되는데 IP주소 전반의 네트워크부를 이용해 각 네트워크를 식별하고 후반의 호스트부로 네트워크 내 호스트(의 인터페이스)를 식별한다.

### IP 주소의 범위 구분
- 서브넷 마스크는 32비트 IP주소의 네트워크부가 어디까지인지 명시한 것 이다.
- '1'은 네트워크부를 나타내며, '0'은 호스트부를 나타낸다.
- 서브넷 마스크는 **반드시 연속한 '1'과 연속한 '0'** 으로 되어있으며 '1'과 '0'이 교대로 나타나는 서브넷 마스크는 존재하지 않는다.
- 서브넷 마스크가 가질 수 있는 값
    - 11111111 (255)
    - 11111110 (254)
    - 11111100 (252)
    - 11111000 (248)
    - 11100000 (224)
    - 11000000 (192)
    - 10000000 (128)
    - 00000000 (0)
- IP 주소 후반 호스트부를 모드 비트 '0'으로 채우면, 네트워크 자체를 식별하기 위해 이용하는 **네트워크 주소**가 된다.
- 호스트부를 모두 비트 '1'로 채우면 **(255.255.255.255)** **브로드캐스트 주소**가 된다. 

### ❗️네트워크와 호스트 개수를 계산하려면 어떻게 해야할까?
> 다음과 같이 IP 주소와 서브넷 마스크가 있다고 가정하자.  
>
> IP 주소 : **192.168.6.25**  
> 서브넷 마스크 : **255.255.255.128**  
> 1. 서브넷 마스크 계산 : 서브넷 마스크를 2진수로 변환해보면 1이 25개, 0이 7개 나온다.
> 2. 호스트 개수 계산 : **2ᴺ -2** 를 하면 된다. (**N : 위에서 계산한 호스트부 (0)의 개수 = 7**) -> **126**  
❗️❗️ 2번에서 -2를 하는 이유 : 네트워크 주소와 브로드캐스트 주소는 호스트로 사용할 수 없기때문에 제외한다.
> 3. 네트워크 개수 계산 : **2ᴺ**을 하면 된다. (**N : 위에서 계산한 네트워크부 (1)의 개수 25 - 기본 네트워크부 24 = 1**)
> 4. 결과 (**네트워크 수 : 2, 호스트 수 : 126**)
> - **첫번째 네트워크** : 192.168.6.0 / 25
>   - **네트워크 주소** : 192.168.6.0
>   - **브로드캐스트 주소** : 192.168.6.127
>   - **사용 가능한 호스트 주소** : 192.168.6.1 ~ 192.168.6.126
> - **두번째 네트워크** : 192.168.6.128 / 25
>   - **네트워크 주소** : 192.168.6.128
>   - **브로드캐스트 주소** : 192.168.6.255
>   - **사용 가능한 호스트 주소** : 192.168.6.129 ~ 192.168.6.254

### 인터넷에서 사용하는 주소와 사설 네트워크에서 사용하는 주소
- IP 주소는 이용 범위에 따라, 공인 IP 주소와 사설 IP 주소로 분류된다.
- 인터넷에서 통신하기 위해서는 반드시 공인된 주소가 필요하고 공인주소는 인터넷 전체에서 중복되지 않도록 관리된다.
- 인터넷을 이용하기 위해 인터넷 접속 서비스를 계약하면 공인 주소가 할당되는데 인터넷 접속 서비스에 따라 공인 주소가 할당되지 않는 경우도 있다.
- 사설 주소의 범위
    - 10.0.0.0 ~ 10.255.255.255 (A클래스)
    - 172.16.0.0 ~ 172.31.255.255 (B클래스)
    - 192.168.0.0 ~ 192.168.255.255 (C클래스)

### ❗️인터넷 접속 서비스에 따라 공인 주소가 할당되지 않는 경우에는 어떤게 있을까?
> 인터넷 접속 서비스에서 공인 IP 주소가 할당되지 않는 경우는 주로 사설 IP 주소를 사용하는 서비스에서 발생한다.  
> ISP 사업자가 제한된 공인 IP 자원을 절약하거나 특정 사용자 요구에 맞는 환경을 제공하기 위해 사설 IP 주소를 사용하는 경우이다.  
>  
> **공인 IP 주소가 할당되지 않는 대표적인 예시**
> - **NAT(Network Address Translation) 사용 시** : NAT는 여러 개의 사설 IP 주소 가 하나의 공인 IP 주소를 공유하여 인터넷에 접속할 수 있도록하는 기술이다. 가정용 인터넷이나 소규모 기업에서 사용하는 공유기(router)가 NAT를 통해 사설 IP 주소를 내부 네트워크에서 사용하고, 외부 네트워크와 통신할 때는 공유기의 공인 IP 주소를 사용하게 된다.
> - **CGN(Carrier-Grade NAT) 사용 시** : CGN 또는 대규모 NAT는 ISP가 자사의 고객들에게 사설 IP 주소를 할당하고, 공인 IP 주소를 공유하게끔 설계한 기술이다. CGN이 적용된 네트워크에서는 사용자에게 사설 IP 주소가 할당되고, 공용 게이트웨이를 통해 공인 IP 주소로 번역되어 인터넷과 통신한다.
> - **모바일 네트워크 사용 시** : 모바일 네트워크(3G, 4G, 5G) 환경에서는 공인 IP 주소가 할당되지 않을 수 있다. 많은 모바일 통신사는 자원의 절약과 보안을 이유로 ***사용자의 단말기에 사설 IP 주소를 할당***하고, 내부적으로 NAT를 통해 공인 IP 주소를 공유하도록 설정한다. 모바일 기기에서 공인 IP 주소가 필요한 경우, 별도의 서비스를 요청해야한다.
> - **VPN 사용 시** : VPN은 보안 연결을 제공하는 방식으로, 사용자가 VPN에 접속하면 ***VPN 서버가 사용자에게 사설 IP 주소를 할당***하는 경우가 많다. 이 경우 VPN을 통해 통신할 때는 VPN 서버의 공인 IP 주소를 사용하게 되며, 실제로 사용자가 공인 IP 주소를 직접 할당받지는 않는다.

### 사설 네트워크에서 인터넷으로의 통신
- 인터넷 통신 시 목적지가 공인 IP 주소이고 출발지가 사설 IP 주소일 경우 요청은 문제없이 진행되나 응답은 받을 수 없다. 이유는 응답을 받을 때 목적지가 사설 IP 주소로 되기 때문이다. **(목적지가 사설 주소로 된 IP 패킷은 반드시 폐기)**
- 사설 네트워크에서 인터넷 통신 방법
    1. 사설 네트워크에서 인터넷으로 요청을 전송할 때, 출발지 IP 주소를 변환한다.
    2. 라우터는 나중에 원래대로 되돌리기 위해 변환한 주소의 대응을 NAT 테이블에 보존한다.
    3. 요청에 대한 응답이 라우터로 돌아오면, 목적지 IP 주소를 변환한다. 이 때 2번에서 보존해 둔 주소의 대응을 이용한다.

